This is dumb. I blame @glennklockwood.

Still missing:
 
 * more careful replication, where we actually have multiple replicas on single hosts (or else make sure we don't try to make more replicas than we have hosts: at the moment they just get overwritten on the same host)
 * nodelist syncing
 * probably a bunch of other things, I don't know

